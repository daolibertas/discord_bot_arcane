
# Discord Arcane Bot Logger

## üìå Overview
This project is a **Discord bot** that listens to messages in a specific channel, particularly those generated by the **Arcane bot**. It extracts level-up messages, processes them, and **stores only the latest state** in a PostgreSQL database.

### üîπ Features:
- Listens to messages in a **specified Discord channel**.
- Extracts the **latest level** reached by a mentioned user.
- **Creates the database and table** automatically if they do not exist.
- Stores data in **PostgreSQL**, ensuring only the latest level is kept.

---

## ‚öôÔ∏è Dependencies
Before installing, ensure you have the following dependencies:

### **1Ô∏è‚É£ PostgreSQL**
The bot stores user level-up information in a PostgreSQL database. Install PostgreSQL using:
```bash
sudo apt update && sudo apt install postgresql postgresql-contrib -y
```

### **2Ô∏è‚É£ Python Packages**
The script requires the following Python packages:
```bash
pip install discord.py psycopg2-binary
```

### **3Ô∏è‚É£ Discord Bot Token & Channel ID**
To function correctly, the bot needs:
- **A Discord bot token** (You must create a bot at [Discord Developer Portal](https://discord.com/developers/applications)).
- **The channel ID** where the bot will read messages.

**üìå Note:** The bot must have **"Read Message History"** and **"Message Content Intent" (Privileged Gateway Intents)** enabled in the Discord Developer settings.

---

## üöÄ Installation Guide

### **Step 1: Create a Project Folder**
```bash
mkdir -p ~/discord-bot
cd ~/discord-bot
```

### **Step 2: Create a Virtual Environment**
```bash
python3 -m venv venv
source venv/bin/activate
```

### **Step 3: Install Dependencies**
```bash
pip install discord.py psycopg2-binary
```

### **Step 4: Configure the Bot**
Edit the `bot.py` script and update the following variables:
```python
DB_USER = "db_user"
DB_PASSWORD = "db_secure_password"
TOKEN = "YOUR_DISCORD_BOT_TOKEN"
CHANNEL_ID = 123456789012345678  # Replace with your actual channel ID
```

---

## üõ†Ô∏è Running the Bot as a Linux Service
To ensure the bot **runs automatically in the background**, follow these steps:

### **Step 1: Create a Systemd Service**
```bash
sudo nano /etc/systemd/system/discord-bot.service
```
Paste the following configuration:
```ini
[Unit]
Description=Discord Bot Service
After=network.target

[Service]
ExecStart=/home/your_user/discord-bot/venv/bin/python3 /home/your_user/discord-bot/bot.py
WorkingDirectory=/home/your_user/discord-bot
StandardOutput=append:/var/log/discord-bot.log
StandardError=append:/var/log/discord-bot.log
Restart=always
User=your_user

[Install]
WantedBy=multi-user.target
```
**üìå Important:** Replace `your_user` with your actual Linux username.

### **Step 2: Reload Systemd & Start the Service**
```bash
sudo systemctl daemon-reload
sudo systemctl enable discord-bot
sudo systemctl start discord-bot
```

### **Step 3: Check if the Bot is Running**
```bash
sudo systemctl status discord-bot
```
If everything is set up correctly, you should see the bot **running in the background**.

---

## üìä Checking the Stored Data
To verify if messages are being stored correctly in PostgreSQL, run:
```bash
psql -U bot_user -d discord_db -h localhost -c "SELECT * FROM aging_table;"
```
Or, use a Python script:
```python
import psycopg2

conn = psycopg2.connect(
    dbname="discord_db",
    user="bot_user",
    password="your_secure_password",
    host="localhost",
    port="5432"
)
cur = conn.cursor()
cur.execute("SELECT * FROM aging_table;")
rows = cur.fetchall()

print("üìä Stored Messages:")
for row in rows:
    print(row)

cur.close()
conn.close()
```

---

## üõë Managing the Service
- **Restart the bot**:
  ```bash
  sudo systemctl restart discord-bot
  ```
- **Stop the bot**:
  ```bash
  sudo systemctl stop discord-bot
  ```
- **View real-time logs**:
  ```bash
  journalctl -u discord-bot -f
  ```

---

## ‚úÖ Conclusion
Your Discord bot is now **fully operational**! üéâ It listens for messages from **Arcane bot**, extracts level-up messages, and stores the latest level of each user in PostgreSQL.

For any improvements or additional features, feel free to contribute!
